<div class="masterlogs-container fade-slide-in">
  <h1 class="masterlogs-title">Master Logs & Audit</h1>
  <p class="masterlogs-description">View and export system-wide logs. Filter by clinic, user, IP address, device, action type, and date/time range.</p>

  <form class="masterlogs-search-form">
    <div class="masterlogs-searchbar-row">
      <div class="admins-searchbar">
        <i class="fa fa-search search-icon"></i>
        <input type="text" placeholder="Search logs" class="admins-search-input" id="masterlogs-search" />
      </div>
    </div>
    
    <!-- Filter Dropdowns Row -->
    <div class="masterlogs-filters-row">
      <div class="filter-dropdown-group">
        <select class="filter-dropdown" id="clinic-filter">
          <option value="" selected>Clinic</option>
          <option value="clinic-a">Clinic A</option>
          <option value="clinic-b">Clinic B</option>
          <option value="clinic-c">Clinic C</option>
          <option value="clinic-d">Clinic D</option>
        </select>
        <i class="fa fa-chevron-down dropdown-arrow"></i>
      </div>
      
      <div class="filter-dropdown-group">
        <select class="filter-dropdown" id="user-filter">
          <option value="" selected>User</option>
          <option value="alex-johnson">Alex Johnson</option>
          <option value="sarah-lee">Sarah Lee</option>
          <option value="michael-chan">Michael Chan</option>
          <option value="olivia-brown">Olivia Brown</option>
          <option value="ethan-clark">Ethan Clark</option>
        </select>
        <i class="fa fa-chevron-down dropdown-arrow"></i>
      </div>
      
      <div class="filter-dropdown-group">
        <select class="filter-dropdown" id="ip-filter">
          <option value="" selected>IP Address</option>
          <option value="192.168.100.100">192.168.100.100</option>
          <option value="192.168.101.101">192.168.101.101</option>
          <option value="192.168.102.110">192.168.102.110</option>
          <option value="192.168.103.104">192.168.103.104</option>
        </select>
        <i class="fa fa-chevron-down dropdown-arrow"></i>
      </div>
      
      <div class="filter-dropdown-group">
        <select class="filter-dropdown" id="device-filter">
          <option value="" selected>Device</option>
          <option value="desktop">Desktop</option>
          <option value="mobile">Mobile</option>
          <option value="tablet">Tablet</option>
        </select>
        <i class="fa fa-chevron-down dropdown-arrow"></i>
      </div>
      
      <div class="filter-dropdown-group">
        <select class="filter-dropdown" id="action-filter">
          <option value="" selected>Action Type</option>
          <option value="login">User Login</option>
          <option value="logout">User Logout</option>
          <option value="appointment-created">Appointment Created</option>
          <option value="appointment-cancelled">Appointment Cancelled</option>
          <option value="record-updated">Patient Record Updated</option>
          <option value="document-uploaded">Document Uploaded</option>
          <option value="payment-received">Payment Received</option>
          <option value="inventory-updated">Inventory Updated</option>
          <option value="message-sent">Message Sent</option>
          <option value="billing-report">Billing Report Generated</option>
        </select>
        <i class="fa fa-chevron-down dropdown-arrow"></i>
      </div>
    </div>
    
    <div class="masterlogs-date-row">
      <div class="date-field">
        <label for="startDate">Start Date</label>
        <input type="date" id="startDate" class="date-input" placeholder="Select start date" />
      </div>
      <div class="date-field">
        <label for="endDate">End Date</label>
        <input type="date" id="endDate" class="date-input" placeholder="Select end date" />
      </div>
    </div>
  </form>

  <div class="masterlogs-table-wrapper admins-table-wrapper">
    <table class="masterlogs-table admins-table">
      <thead>
        <tr>
          <th>Timestamp</th>
          <th>User/Clinic</th>
          <th>IP Address</th>
          <th>Device</th>
          <th>Action</th>
          <th>Data</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>2024-01-15 10:33:00</td>
          <td class="clinic-muted">Clinic A</td>
          <td>192.168.100.100</td>
          <td>Desktop</td>
          <td>User Login</td>
          <td>User: Alex Johnson</td>
        </tr>
        <tr>
          <td>2024-01-15 10:40:00</td>
          <td class="clinic-muted">User: Sarah Lee</td>
          <td>192.168.101.101</td>
          <td>Mobile</td>
          <td>Appointment Created</td>
          <td>Patient: Emily White</td>
        </tr>
        <tr>
          <td>2024-01-15 12:00:00</td>
          <td class="clinic-muted">Clinic B</td>
          <td>192.168.102.110</td>
          <td>Tablet</td>
          <td>Patient Record Updated</td>
          <td>Patient: David Green</td>
        </tr>
        <tr>
          <td>2024-01-15 13:01:00</td>
          <td class="clinic-muted">User: Michael Chan</td>
          <td>192.168.103.104</td>
          <td>Desktop</td>
          <td>Document Uploaded</td>
          <td>File: Report.pdf</td>
        </tr>
        <tr>
          <td>2024-01-15 13:05:00</td>
          <td class="clinic-muted">Clinic A</td>
          <td>192.168.100.100</td>
          <td>Mobile</td>
          <td>Payment Received</td>
          <td>Amount: $100</td>
        </tr>
        <tr>
          <td>2024-01-15 13:10:00</td>
          <td class="clinic-muted">User: Olivia Brown</td>
          <td>192.168.105.106</td>
          <td>Desktop</td>
          <td>User Logout</td>
          <td>User: Olivia Brown</td>
        </tr>
        <tr>
          <td>2024-01-15 13:20:00</td>
          <td class="clinic-muted">Clinic C</td>
          <td>192.168.106.108</td>
          <td>Tablet</td>
          <td>Inventory Updated</td>
          <td>Item: Bandages</td>
        </tr>
        <tr>
          <td>2024-01-15 13:30:00</td>
          <td class="clinic-muted">User: Ethan Clark</td>
          <td>192.168.107.109</td>
          <td>Mobile</td>
          <td>Message Sent</td>
          <td>Recipient: Sophia Roberts</td>
        </tr>
        <tr>
          <td>2024-01-15 13:40:00</td>
          <td class="clinic-muted">Clinic D</td>
          <td>192.168.108.110</td>
          <td>Desktop</td>
          <td>Billing Report Generated</td>
          <td>Date: 2024-01-15</td>
        </tr>
        <tr>
          <td>2024-01-15 13:50:00</td>
          <td class="clinic-muted">User: Aqa Wilson</td>
          <td>192.168.109.109</td>
          <td>Mobile</td>
          <td>Appointment Cancelled</td>
          <td>Patient: Noah Taylor</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="masterlogs-actions" style="margin-top: 18px;">
    <button class="export-logs-btn">Export Logs</button>
  </div>
</div>

<script>
// Master Logs Filter Functionality
document.addEventListener('DOMContentLoaded', function() {
  const searchInput = document.getElementById('masterlogs-search');
  const clinicFilter = document.getElementById('clinic-filter');
  const userFilter = document.getElementById('user-filter');
  const ipFilter = document.getElementById('ip-filter');
  const deviceFilter = document.getElementById('device-filter');
  const actionFilter = document.getElementById('action-filter');
  const startDateFilter = document.getElementById('startDate');
  const endDateFilter = document.getElementById('endDate');
  const tableRows = document.querySelectorAll('.masterlogs-table tbody tr');

  // Filter function
  function filterTable() {
    const searchTerm = searchInput.value.toLowerCase();
    const clinicValue = clinicFilter.value;
    const userValue = userFilter.value;
    const ipValue = ipFilter.value;
    const deviceValue = deviceFilter.value;
    const actionValue = actionFilter.value;
    const startDate = startDateFilter.value;
    const endDate = endDateFilter.value;

    tableRows.forEach(row => {
      const cells = row.querySelectorAll('td');
      const timestamp = cells[0].textContent;
      const userClinic = cells[1].textContent.toLowerCase();
      const ipAddress = cells[2].textContent;
      const device = cells[3].textContent.toLowerCase();
      const action = cells[4].textContent.toLowerCase();
      const data = cells[5].textContent.toLowerCase();

      // Check all filter conditions
      let showRow = true;

      // Search filter
      if (searchTerm && !userClinic.includes(searchTerm) && 
          !ipAddress.includes(searchTerm) && !device.includes(searchTerm) && 
          !action.includes(searchTerm) && !data.includes(searchTerm)) {
        showRow = false;
      }

      // Clinic filter
      if (clinicValue && !userClinic.includes(clinicValue.replace('-', ' '))) {
        showRow = false;
      }

      // User filter (simplified)
      if (userValue && !userClinic.includes(userValue.replace('-', ' '))) {
        showRow = false;
      }

      // IP filter
      if (ipValue && !ipAddress.includes(ipValue)) {
        showRow = false;
      }

      // Device filter
      if (deviceValue && !device.includes(deviceValue)) {
        showRow = false;
      }

      // Action filter
      if (actionValue) {
        const actionMap = {
          'login': 'user login',
          'logout': 'user logout',
          'appointment-created': 'appointment created',
          'appointment-cancelled': 'appointment cancelled',
          'record-updated': 'record updated',
          'document-uploaded': 'document uploaded',
          'payment-received': 'payment received',
          'inventory-updated': 'inventory updated',
          'message-sent': 'message sent',
          'billing-report': 'billing report'
        };
        if (!action.includes(actionMap[actionValue] || actionValue)) {
          showRow = false;
        }
      }

      // Date filters (basic implementation)
      if (startDate || endDate) {
        const rowDate = new Date(timestamp.split(' ')[0]);
        if (startDate && rowDate < new Date(startDate)) {
          showRow = false;
        }
        if (endDate && rowDate > new Date(endDate)) {
          showRow = false;
        }
      }

      // Show/hide row
      row.style.display = showRow ? '' : 'none';
    });
  }

  // Add event listeners
  searchInput.addEventListener('input', filterTable);
  clinicFilter.addEventListener('change', filterTable);
  userFilter.addEventListener('change', filterTable);
  ipFilter.addEventListener('change', filterTable);
  deviceFilter.addEventListener('change', filterTable);
  actionFilter.addEventListener('change', filterTable);
  startDateFilter.addEventListener('change', filterTable);
  endDateFilter.addEventListener('change', filterTable);

  // Export functionality
  document.querySelector('.export-logs-btn').addEventListener('click', function() {
    alert('Export functionality would be implemented here');
  });
});
</script> 